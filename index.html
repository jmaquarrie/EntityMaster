<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>EntityMaster Diagram</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
      integrity="sha512-HY0yxu8aAkaI0s5momkGLumZ5qX6Ch12yvDqOiiMHDL/95B2S/bRMyCV2wE8p8nH3UX0YPD9PEw24hHJcG0zOA=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="app">
      <div class="workspace">
        <div class="canvas-shell">
          <div id="canvasViewport">
            <div id="canvasContent">
              <svg id="connectionLayer"></svg>
              <div id="canvas" tabindex="0"></div>
            </div>
          </div>
          <div class="canvas-toolbar" aria-label="Canvas controls">
            <div class="toolbar-actions">
              <button id="addSystemBtn">Add System</button>
              <button id="clearFocusBtn" class="ghost">Clear Highlights</button>
            </div>
            <div class="zoom-controls" aria-label="Zoom">
              <div class="storage-controls" aria-label="Diagram storage">
                <button id="saveDiagramBtn" class="icon-btn" title="Save diagram" aria-label="Save diagram">ðŸ’¾</button>
                <button id="loadDiagramBtn" class="icon-btn" title="Load diagram" aria-label="Load diagram">ðŸ“‚</button>
                <button id="shareDiagramBtn" class="icon-btn" title="Share diagram" aria-label="Share diagram">
                  <i class="fa-solid fa-share-nodes" aria-hidden="true"></i>
                </button>
              </div>
              <button id="settingsBtn" class="icon-btn" title="Diagram settings" aria-label="Diagram settings">
                <i class="fa-solid fa-gear" aria-hidden="true"></i>
              </button>
              <button class="zoom-btn" data-direction="out" aria-label="Zoom out">âˆ’</button>
              <span id="zoomLabel">100%</span>
              <button class="zoom-btn" data-direction="in" aria-label="Zoom in">+</button>
            </div>
          </div>
        </div>
        <aside id="filterPanel" class="sidebar collapsed" aria-label="Filters">
          <button id="filterPanelToggle" class="sidebar-toggle" aria-expanded="false">
            <span class="toggle-label">Filters &amp; Search</span>
            <span class="toggle-icon" aria-hidden="true">+</span>
          </button>
          <div class="sidebar-content">
            <div class="sidebar-section">
              <label class="field">
                <span>Filter Mode</span>
                <select id="filterModeSelect">
                  <option value="fade">Fade</option>
                  <option value="hide">Hide</option>
                </select>
              </label>
              <label class="field">
                <span>Search Type</span>
                <select id="searchType">
                  <option value="system">System</option>
                  <option value="domain">Domain</option>
                  <option value="platformOwner">Platform Owner</option>
                  <option value="businessOwner">Business Owner</option>
                  <option value="functionOwner">Function Owner</option>
                  <option value="entity">Entity</option>
                </select>
              </label>
              <label class="field">
                <span>Search</span>
                <input type="text" id="searchInput" placeholder="Searchâ€¦" />
              </label>
            </div>
            <div class="sidebar-section">
              <div class="section-title">Domains</div>
              <div id="globalDomainChips" class="domain-chips"></div>
            </div>
            <div class="sidebar-section">
              <div class="section-title">Platform Owner</div>
              <input
                type="text"
                id="platformOwnerFilter"
                placeholder="Filter by platform owner"
                list="platformOwnerSuggestions"
              />
            </div>
            <div class="sidebar-section">
              <div class="section-title">Business Owner</div>
              <input
                type="text"
                id="businessOwnerFilter"
                placeholder="Filter by business owner"
                list="businessOwnerSuggestions"
              />
            </div>
            <div class="sidebar-section">
              <div class="section-title">Function Owner</div>
              <input
                type="text"
                id="functionOwnerFilter"
                placeholder="Filter by function owner"
                list="functionOwnerOptions"
              />
            </div>
            <div class="sidebar-section">
              <label class="field">
                <span>System of Record</span>
                <select id="sorFilter">
                  <option value="any">Any</option>
                  <option value="yes">Yes</option>
                  <option value="no">No</option>
                </select>
              </label>
            </div>
          </div>
        </aside>
      </div>
      <aside id="systemPanel" class="panel hidden" aria-live="polite">
        <div class="panel-header">
          <h2 id="panelTitle">System</h2>
          <button id="closePanelBtn" aria-label="Close panel">Ã—</button>
        </div>
        <label class="field">
          <span>System Name</span>
          <input type="text" id="systemNameInput" />
        </label>
        <label class="field">
          <span>Platform Owner</span>
          <input
            type="text"
            id="platformOwnerInput"
            placeholder="Name or team"
            list="platformOwnerSuggestions"
          />
        </label>
        <label class="field">
          <span>Business Owner</span>
          <input
            type="text"
            id="businessOwnerInput"
            placeholder="Name or team"
            list="businessOwnerSuggestions"
          />
        </label>
        <label class="field">
          <span>Function Owner</span>
          <input
            type="text"
            id="functionOwnerInput"
            placeholder="Select or add"
            list="functionOwnerOptions"
          />
        </label>
        <label class="field">
          <span>System Icon</span>
          <select id="systemIconSelect">
            <option value="fa-solid fa-cube">Cube</option>
            <option value="fa-solid fa-database">Database</option>
            <option value="fa-solid fa-cloud">Cloud</option>
            <option value="fa-solid fa-server">Server</option>
            <option value="fa-solid fa-diagram-project">Project</option>
            <option value="fa-solid fa-building">Building</option>
            <option value="fa-solid fa-network-wired">Network</option>
            <option value="fa-solid fa-chart-line">Growth</option>
            <option value="fa-solid fa-shield">Shield</option>
            <option value="fa-solid fa-rocket">Rocket</option>
          </select>
        </label>
        <section class="field">
          <div class="section-title">Entities</div>
          <form id="entityForm">
            <input type="text" id="entityInput" placeholder="Add entity" required />
            <button type="submit">Add</button>
          </form>
          <ul id="entityList" class="entity-list"></ul>
        </section>
        <section class="field">
          <div class="section-title">Domains</div>
          <div id="panelDomainChoices" class="domain-choices"></div>
        </section>
        <label class="field">
          <span>Comments</span>
          <textarea id="systemCommentsInput" rows="3" placeholder="Add notes or context"></textarea>
        </label>
      </aside>
      <div id="bulkModal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="bulkModalTitle">
        <div class="modal-card">
          <div class="modal-header">
            <h3 id="bulkModalTitle">Bulk Edit Systems</h3>
            <button id="closeBulkModal" class="icon-btn" type="button" aria-label="Close bulk edit">Ã—</button>
          </div>
          <p class="modal-description">Apply owner or domain changes to every system inside your selection.</p>
          <ul id="bulkSelectionList" class="selection-list"></ul>
          <form id="bulkForm">
            <label class="field">
              <span>Platform Owner</span>
              <input
                type="text"
                id="bulkPlatformOwner"
                placeholder="Leave blank to keep current"
                list="platformOwnerSuggestions"
              />
            </label>
            <label class="field">
              <span>Business Owner</span>
              <input
                type="text"
                id="bulkBusinessOwner"
                placeholder="Leave blank to keep current"
                list="businessOwnerSuggestions"
              />
            </label>
            <label class="field">
              <span>Function Owner</span>
              <input
                type="text"
                id="bulkFunctionOwner"
                placeholder="Leave blank to keep current"
                list="functionOwnerOptions"
              />
            </label>
            <div class="field">
              <div class="section-title">Domains</div>
              <p class="modal-hint">Click a domain to toggle between Add â†’ Remove â†’ Ignore.</p>
              <div id="bulkDomainControls" class="bulk-domain-controls"></div>
            </div>
            <div class="modal-actions">
              <button type="button" id="cancelBulkBtn" class="ghost">Cancel</button>
              <button type="submit">Apply Changes</button>
            </div>
          </form>
        </div>
      </div>
      <div
        id="saveManagerModal"
        class="modal hidden"
        role="dialog"
        aria-modal="true"
        aria-labelledby="saveModalTitle"
      >
        <div class="modal-card">
          <div class="modal-header">
            <h3 id="saveModalTitle">Saved Diagrams</h3>
            <button id="closeSaveModal" class="icon-btn" type="button" aria-label="Close saved diagrams">Ã—</button>
          </div>
          <p class="modal-description">Load, rename, or delete any saved snapshot.</p>
          <div id="saveList" class="save-list"></div>
        </div>
      </div>
      <div id="settingsModal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="settingsModalTitle">
        <div class="modal-card">
          <div class="modal-header">
            <h3 id="settingsModalTitle">Diagram Settings</h3>
            <button id="closeSettingsModal" class="icon-btn" type="button" aria-label="Close settings">Ã—</button>
          </div>
          <label class="field">
            <span>Colour By</span>
            <select id="colorBySelect">
              <option value="none">None</option>
              <option value="domains">Domains</option>
              <option value="functionOwner">Function Owner</option>
              <option value="businessOwner">Business Owner</option>
              <option value="platformOwner">Platform Owner</option>
            </select>
          </label>
        </div>
      </div>
      <datalist id="platformOwnerSuggestions"></datalist>
      <datalist id="businessOwnerSuggestions"></datalist>
      <datalist id="functionOwnerOptions"></datalist>
      <button id="undoDeleteBtn" class="undo-button hidden" type="button">Undo delete</button>
    </div>
    <script src="script.js"></script>
  </body>
</html>
